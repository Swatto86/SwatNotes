<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SwatNotes</title>
  <!-- Apply theme immediately to prevent flash -->
  <script>
    (function () {
      const theme = localStorage.getItem('swatnotes-theme') || 'light';
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>
  <!-- Critical CSS to prevent white flash before stylesheet loads -->
  <style>
    html,
    body {
      background-color: oklch(var(--b1, 100% 0 0));
      margin: 0;
      padding: 0;
    }
  </style>
  <link rel="stylesheet" href="/src/styles/main.css" />
  <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet" />
</head>

<body class="bg-base-100">
  <div id="app" class="flex h-screen bg-base-100">
    <!-- Sidebar: Collections navigation only -->
    <aside class="w-56 bg-base-200 border-r border-base-300 flex flex-col flex-shrink-0">
      <!-- App Header -->
      <div class="px-3 pt-3 pb-2 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-primary flex-shrink-0" fill="none"
          viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
        </svg>
        <h1 class="text-base font-bold text-base-content">SwatNotes</h1>
        <div id="version-badge" class="badge badge-ghost badge-xs">v0.0.0</div>
      </div>

      <!-- New Note Button -->
      <div class="px-3 pb-2">
        <button id="new-note-btn" class="btn btn-primary btn-sm w-full gap-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg>
          New Note
        </button>
      </div>

      <!-- Search -->
      <div class="px-3 pb-2">
        <input type="text" placeholder="Search notes..." class="input input-bordered input-sm w-full text-base-content"
          id="search-input" />
      </div>

      <div class="divider my-0 mx-3"></div>

      <!-- Collections -->
      <div class="flex-1 overflow-y-auto px-2 py-2">
        <div class="flex items-center justify-between px-2 mb-1">
          <button id="collections-toggle" class="flex items-center gap-1 hover:text-base-content">
            <svg id="collections-chevron" xmlns="http://www.w3.org/2000/svg"
              class="h-3.5 w-3.5 transition-transform text-base-content/70" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
            <span class="font-semibold text-xs uppercase tracking-wider text-base-content/60">Collections</span>
          </button>
          <button id="sidebar-add-collection-btn" class="btn btn-ghost btn-xs btn-circle" title="Add collection">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
          </button>
        </div>
        <div id="collections-list" class="space-y-0.5">
          <!-- All Notes -->
          <button id="filter-all-notes"
            class="w-full flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm text-base-content hover:bg-base-300 bg-base-300 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-base-content/60 flex-shrink-0" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
            </svg>
            <span class="flex-1 text-left text-sm">All Notes</span>
            <span id="all-notes-count" class="text-xs text-base-content/50">0</span>
          </button>
          <!-- Uncategorized -->
          <button id="filter-uncategorized"
            class="w-full flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm text-base-content hover:bg-base-300 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-base-content/60 flex-shrink-0" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />
            </svg>
            <span class="flex-1 text-left text-sm">Uncategorized</span>
            <span id="uncategorized-count" class="text-xs text-base-content/50">0</span>
          </button>
          <!-- Reminders -->
          <button id="filter-reminders"
            class="w-full flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm text-base-content hover:bg-base-300 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-base-content/60 flex-shrink-0" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
            </svg>
            <span class="flex-1 text-left text-sm">Reminders</span>
            <span id="reminders-count" class="text-xs text-base-content/50">0</span>
          </button>
          <!-- Dynamic collections -->
          <div id="collections-items"></div>
        </div>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="flex-1 flex flex-col min-w-0">
      <!-- Notes list / Editor area -->
      <div class="flex-1 overflow-y-auto" id="editor-container">
        <!-- Notes grid is rendered here when browsing, editor when editing -->
        <div id="notes-list-view" class="p-6">
          <div id="notes-list-header" class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold text-base-content">All Notes</h2>
            <span id="notes-list-count" class="text-sm text-base-content/50"></span>
          </div>
          <div id="notes-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3">
            <div class="text-center text-base-content/50 py-8 col-span-full">
              No notes yet
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Color picker modal for collections -->
  <dialog id="color-picker-modal" class="modal">
    <div class="modal-box max-w-xs">
      <h3 class="font-bold text-lg mb-4">Choose Color</h3>
      <div id="color-picker-grid" class="grid grid-cols-6 gap-2">
        <!-- Colors rendered by JS -->
      </div>
      <div class="modal-action">
        <form method="dialog">
          <button class="btn btn-sm">Cancel</button>
        </form>
      </div>
    </div>
    <form method="dialog" class="modal-backdrop">
      <button>close</button>
    </form>
  </dialog>

  <script type="module" src="/src/main.ts"></script>
</body>

</html>